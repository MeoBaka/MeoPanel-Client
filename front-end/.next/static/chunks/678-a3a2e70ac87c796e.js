"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{3511:function(e,t,o){o.d(t,{Z:function(){return n}});var a=o(7821),r=o(8078),s=o(8504);function n(e){let{user:t,logout:o,onLogin:n}=e,[i,l]=(0,r.useState)(!1),c=(0,s.useRouter)();return(0,a.jsx)("header",{className:"bg-gray-800 border-b border-gray-700",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("button",{onClick:()=>c.push("/"),className:"text-2xl font-bold text-blue-400 hover:text-blue-300 cursor-pointer transition-colors",children:"MeoPanel Client"})}),(0,a.jsx)("nav",{className:"flex space-x-4 relative",children:t?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>l(!i),className:"text-white hover:text-gray-300 transition-colors",children:[t.name||t.username," â–¼"]}),i&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-gray-800 border border-gray-700 rounded-md shadow-lg z-10",children:[(0,a.jsx)("button",{onClick:()=>{c.push("/dashboard"),l(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700",children:"Dashboard"}),(0,a.jsx)("button",{onClick:()=>{c.push("/settings"),l(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700",children:"Settings"}),(0,a.jsx)("button",{onClick:()=>{o(),l(!1)},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700",children:"Logout"})]})]}):n?(0,a.jsx)("button",{onClick:n,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors",children:"Login"}):null})]})})})}},9926:function(e,t,o){o.d(t,{AuthProvider:function(){return n},a:function(){return i}});var a=o(7821),r=o(8078);let s=(0,r.createContext)(void 0);function n(e){let{children:t}=e,[o,n]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0),[c,h]=(0,r.useState)(!1),[u,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=setTimeout(()=>{d()},500),t=setTimeout(()=>{l(!1)},1e4);return()=>{clearTimeout(e),clearTimeout(t)}},[]);let d=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{let t=localStorage.getItem("accessToken");if(t){let o=await fetch("http://localhost:5000/auth/me",{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(o.ok){let e=await o.json();n(e),l(!1)}else if(401===o.status)await p(),l(!1);else if(o.status>=500&&e<3){setTimeout(()=>d(e+1),1e3*(e+1));return}else l(!1)}else l(!1)}catch(t){if(console.error("Auth check failed:",t),e<3){setTimeout(()=>d(e+1),1e3*(e+1));return}l(!1)}},p=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{let t=localStorage.getItem("refreshToken");if(!t){l(!1);return}let o=await fetch("http://localhost:5000/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(o.ok){let e=await o.json();localStorage.setItem("accessToken",e.accessToken),localStorage.setItem("refreshToken",e.refreshToken);let t=await fetch("http://localhost:5000/auth/me",{headers:{Authorization:"Bearer ".concat(e.accessToken),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();n(e)}l(!1)}else if(o.status>=500&&e<3){setTimeout(()=>p(e+1),1e3*(e+1));return}else y(),l(!1)}catch(t){if(console.error("Token refresh failed:",t),e<3){setTimeout(()=>p(e+1),1e3*(e+1));return}y(),l(!1)}},g=async(e,t,o)=>{let a=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usernameOrEmail:e,password:t,twoFactorCode:o})}),r=await a.json();if(!a.ok)throw Error(r.message||"Login failed");return r.requiresTwoFactor?(localStorage.setItem("tempLogin",JSON.stringify({email:e,password:t})),h(!0),f(r.userId)):(localStorage.setItem("accessToken",r.accessToken),localStorage.setItem("refreshToken",r.refreshToken),n(r.user),h(!1),f(null)),r},m=async e=>{let t=await fetch("http://localhost:5000/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await t.json();if(!t.ok)throw Error(o.message||"Registration failed");return o},y=async()=>{try{{let e=localStorage.getItem("refreshToken");e&&await fetch("http://localhost:5000/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})})}}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),n(null),h(!1),f(null)}},w=async()=>{try{{let e=localStorage.getItem("accessToken");await fetch("http://localhost:5000/auth/logout-all",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})}}catch(e){console.error("Logout all error:",e)}finally{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),n(null),h(!1),f(null)}},T=async()=>{let e=localStorage.getItem("accessToken"),t=await fetch("http://localhost:5000/auth/sessions",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),o=await t.json();if(!t.ok)throw Error(o.message||"Get sessions failed");return o},S=async e=>{let t=localStorage.getItem("accessToken"),o=await fetch("http://localhost:5000/auth/logout-session",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({sessionId:e})}),a=await o.json();if(!o.ok)throw Error(a.message||"Logout session failed");return a},k=async e=>{let t=await fetch("http://localhost:5000/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),o=await t.json();if(!t.ok)throw Error(o.message||"Forgot password failed");return o},j=async(e,t,o)=>{let a=await fetch("http://localhost:5000/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,newPassword:t,confirmNewPassword:o})}),r=await a.json();if(!a.ok)throw Error(r.message||"Reset password failed");return r},b=async(e,t)=>{let o=localStorage.getItem("accessToken"),a=await fetch("http://localhost:5000/auth/change-password",{method:"POST",headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"},body:JSON.stringify({currentPassword:e,newPassword:t})}),r=await a.json();if(!a.ok)throw Error(r.message||"Change password failed");return r},x=async e=>{let t=await fetch("http://localhost:5000/auth/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),o=await t.json();if(!t.ok)throw Error(o.message||"Email verification failed");return o},v=async e=>{let t=await fetch("http://localhost:5000/auth/resend-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),o=await t.json();if(!t.ok)throw Error(o.message||"Resend verification failed");return o},C=async()=>{let e=localStorage.getItem("accessToken"),t=await fetch("http://localhost:5000/auth/2fa/setup",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),o=await t.json();if(!t.ok)throw Error(o.message||"Setup 2FA failed");return o},O=async e=>{let t=localStorage.getItem("accessToken"),o=await fetch("http://localhost:5000/auth/2fa/verify",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({token:e})}),a=await o.json();if(!o.ok)throw Error(a.message||"Verify 2FA failed");return a},N=async(e,t)=>{let o=localStorage.getItem("accessToken"),a=await fetch("http://localhost:5000/auth/2fa/disable",{method:"POST",headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"},body:JSON.stringify({verificationToken:e,currentPassword:t})}),r=await a.json();if(!a.ok)throw Error(r.message||"Disable 2FA failed");return r},I=async(e,t)=>{let o=localStorage.getItem("accessToken"),a=await fetch("http://localhost:5000/auth/2fa/regenerate-backup",{method:"POST",headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"},body:JSON.stringify({verificationToken:e,currentPassword:t})}),r=await a.json();if(!a.ok)throw Error(r.message||"Regenerate backup codes failed");return r},P=async()=>{let e=localStorage.getItem("accessToken"),t=await fetch("http://localhost:5000/auth/2fa/status",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),o=await t.json();if(!t.ok)throw Error(o.message||"Get 2FA status failed");return o};return(0,a.jsx)(s.Provider,{value:{user:o,login:g,register:m,logout:y,logoutAll:w,getSessions:T,logoutSession:S,forgotPassword:k,resetPassword:j,changePassword:b,verifyEmail:x,resendVerification:v,setupTwoFactor:C,verifyTwoFactor:O,disableTwoFactor:N,regenerateBackupCodes:I,getTwoFactorStatus:P,cancelTwoFactor:()=>{localStorage.removeItem("tempLogin"),h(!1),f(null)},isLoading:i,requiresTwoFactor:c,twoFactorUserId:u},children:t})}function i(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8504:function(e,t,o){var a=o(3226);o.o(a,"useRouter")&&o.d(t,{useRouter:function(){return a.useRouter}}),o.o(a,"useSearchParams")&&o.d(t,{useSearchParams:function(){return a.useSearchParams}})}}]);
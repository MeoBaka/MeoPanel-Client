(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{7013:function(e,s,t){Promise.resolve().then(t.bind(t,6790))},6790:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x},dynamic:function(){return u}});var r=t(7821),a=t(8078),n=t(9926);function o(){let[e,s]=(0,a.useState)(null),[t,o]=(0,a.useState)(""),[i,l]=(0,a.useState)(""),[d,c]=(0,a.useState)([]),[m,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(""),[g,b]=(0,a.useState)(""),[p,f]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(""),[P,L]=(0,a.useState)(""),{setupTwoFactor:E,verifyTwoFactor:A,disableTwoFactor:F,regenerateBackupCodes:T,getTwoFactorStatus:V}=(0,n.a)();(0,a.useEffect)(()=>{D()},[]);let D=async()=>{try{let e=await V();s(e)}catch(e){h(e.message)}},R=async()=>{u(!0),h(""),b("");try{let e=await E();o(e.qrCode),b("QR code generated. Scan with your authenticator app.")}catch(e){h(e.message)}finally{u(!1)}},B=async e=>{e.preventDefault(),u(!0),h(""),b("");try{let e=await A(i);c(e.backupCodes),f(!0),o(""),l(""),await D(),b("Two-factor authentication enabled successfully!")}catch(e){h(e.message)}finally{u(!1)}},M=async e=>{e.preventDefault(),u(!0),h(""),b("");try{await F(C,P),s({isEnabled:!1,isSetup:!1}),o(""),c([]),f(!1),v(!1),S(""),L(""),b("Two-factor authentication disabled successfully.")}catch(e){h(e.message)}finally{u(!1)}},q=async e=>{e.preventDefault(),u(!0),h(""),b("");try{let e=await T(C,P);c(e.backupCodes),f(!0),k(!1),S(""),L(""),b("Backup codes regenerated successfully.")}catch(e){h(e.message)}finally{u(!1)}};return e?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-white mb-4",children:"Two-Factor Authentication"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-white",children:"Status"}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:[e.isEnabled?"Enabled":"Disabled",e.isSetup&&!e.isEnabled&&" (Setup in progress)"]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[!e.isEnabled&&(0,r.jsx)("button",{onClick:R,disabled:m,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm disabled:opacity-50 transition-colors",children:m?"Setting up...":"Setup 2FA"}),e.isEnabled&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{k(!0)},disabled:m,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded text-sm disabled:opacity-50 transition-colors",children:m?"Regenerating...":"New Backup Codes"}),(0,r.jsx)("button",{onClick:()=>{v(!0)},disabled:m,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm disabled:opacity-50 transition-colors",children:m?"Disabling...":"Disable 2FA"})]})]})]}),t&&(0,r.jsxs)("div",{className:"border border-gray-600 rounded-lg p-4 bg-gray-700",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-white mb-2",children:"Scan QR Code"}),(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("img",{src:t,alt:"QR Code",className:"max-w-xs"})}),(0,r.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:"Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)"}),(0,r.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-300",children:"Enter verification code"}),(0,r.jsx)("input",{id:"code",type:"text",required:!0,value:i,onChange:e=>l(e.target.value.replace(/\D/g,"").slice(0,6)),className:"mt-1 block w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-lg transition-colors",placeholder:"000000",maxLength:6})]}),(0,r.jsx)("button",{type:"submit",disabled:m||6!==i.length,className:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm disabled:opacity-50 transition-colors",children:m?"Verifying...":"Verify & Enable 2FA"})]})]}),p&&d.length>0&&(0,r.jsxs)("div",{className:"border border-yellow-600 rounded-lg p-4 bg-yellow-900 bg-opacity-20",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-yellow-200 mb-2",children:"⚠️ Save Your Backup Codes"}),(0,r.jsx)("p",{className:"text-sm text-yellow-300 mb-4",children:"These codes can be used to access your account if you lose your authenticator device. Save them in a secure place."}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:d.map((e,s)=>(0,r.jsx)("div",{className:"bg-gray-700 p-2 rounded border border-gray-600 text-center font-mono text-sm text-white",children:e},s))}),(0,r.jsx)("button",{onClick:()=>f(!1),className:"w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded text-sm transition-colors",children:"I've Saved These Codes"})]}),e.isEnabled&&(0,r.jsxs)("div",{className:"border border-green-600 rounded-lg p-4 bg-green-900 bg-opacity-20",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-green-200 mb-2",children:"✅ Two-Factor Authentication is Enabled"}),(0,r.jsxs)("p",{className:"text-sm text-green-300",children:["Your account is now protected with two-factor authentication. You have ",e.backupCodesCount," backup codes remaining."]})]}),x&&(0,r.jsx)("div",{className:"text-red-400 text-sm bg-red-900 bg-opacity-20 border border-red-600 p-3 rounded",children:x}),g&&(0,r.jsx)("div",{className:"text-green-400 text-sm bg-green-900 bg-opacity-20 border border-green-600 p-3 rounded",children:g})]})]})}),w&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border border-gray-700 w-96 shadow-lg rounded-md bg-gray-800",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Disable Two-Factor Authentication"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"To disable 2FA, please provide your current password and either a 2FA code from your authenticator app or a backup code."}),(0,r.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"verificationToken",className:"block text-sm font-medium text-gray-300",children:"Verification Code"}),(0,r.jsx)("input",{id:"verificationToken",type:"text",required:!0,value:C,onChange:e=>S(e.target.value.toUpperCase().slice(0,8)),className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-2xl tracking-widest font-mono",placeholder:"000000/ABC12345",maxLength:8}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Enter a 6-digit code from your authenticator or an 8-character backup code"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-300",children:"Current Password"}),(0,r.jsx)("input",{id:"currentPassword",type:"password",required:!0,value:P,onChange:e=>L(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your current password"})]}),x&&(0,r.jsx)("div",{className:"text-red-400 text-sm bg-red-900 bg-opacity-20 border border-red-600 p-3 rounded",children:x}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{v(!1),S(""),L("")},className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:m||C.length<6||!P,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:m?"Disabling...":"Disable 2FA"})]})]})]})})}),N&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border border-gray-700 w-96 shadow-lg rounded-md bg-gray-800",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Regenerate Backup Codes"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"To regenerate backup codes, please provide your current password and either a 2FA code from your authenticator app or a backup code."}),(0,r.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"regenerateVerificationToken",className:"block text-sm font-medium text-gray-300",children:"Verification Code"}),(0,r.jsx)("input",{id:"regenerateVerificationToken",type:"text",required:!0,value:C,onChange:e=>S(e.target.value.toUpperCase().slice(0,8)),className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-2xl tracking-widest font-mono",placeholder:"000000/ABC12345",maxLength:8}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Enter a 6-digit code from your authenticator or an 8-character backup code"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"regenerateCurrentPassword",className:"block text-sm font-medium text-gray-300",children:"Current Password"}),(0,r.jsx)("input",{id:"regenerateCurrentPassword",type:"password",required:!0,value:P,onChange:e=>L(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your current password"})]}),x&&(0,r.jsx)("div",{className:"text-red-400 text-sm bg-red-900 bg-opacity-20 border border-red-600 p-3 rounded",children:x}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{k(!1),S(""),L("")},className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:m||C.length<6||!P,className:"px-4 py-2 text-sm font-medium text-white bg-yellow-600 border border-transparent rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50",children:m?"Regenerating...":"Regenerate Codes"})]})]})]})})})]}):(0,r.jsx)("div",{className:"text-center text-gray-400",children:"Loading..."})}function i(){let[e,s]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[t,o]=(0,a.useState)(!1),[i,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),{changePassword:m}=(0,n.a)(),u=async t=>{if(t.preventDefault(),o(!0),l(""),c(""),e.newPassword!==e.confirmPassword){l("New passwords do not match"),o(!1);return}if(e.newPassword.length<6){l("New password must be at least 6 characters long"),o(!1);return}try{await m(e.currentPassword,e.newPassword),c("Password changed successfully. You will be logged out from other devices."),s({currentPassword:"",newPassword:"",confirmPassword:""})}catch(e){l(e.message)}finally{o(!1)}},x=e=>{s(s=>({...s,[e.target.name]:e.target.value}))};return(0,r.jsx)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-white mb-4",children:"Change Password"}),(0,r.jsxs)("form",{onSubmit:u,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-300",children:"Current Password"}),(0,r.jsx)("input",{id:"currentPassword",name:"currentPassword",type:"password",required:!0,value:e.currentPassword,onChange:x,className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-300",children:"New Password"}),(0,r.jsx)("input",{id:"newPassword",name:"newPassword",type:"password",required:!0,value:e.newPassword,onChange:x,className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300",children:"Confirm New Password"}),(0,r.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:e.confirmPassword,onChange:x,className:"mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),i&&(0,r.jsx)("div",{className:"text-red-400 text-sm",children:i}),d&&(0,r.jsx)("div",{className:"text-green-400 text-sm",children:d}),(0,r.jsx)("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 transition-colors",children:t?"Changing Password...":"Change Password"})]})]})})}function l(e){let{isOpen:s,title:t,message:n,confirmText:o="Confirm",cancelText:i="Cancel",onConfirm:l,onCancel:d}=e;return((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&d()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,d]),s)?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:d}),(0,r.jsxs)("div",{className:"relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:t}),(0,r.jsx)("p",{className:"text-gray-300 text-sm",children:n})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 hover:bg-gray-600 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:i}),(0,r.jsx)("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-red-500",children:o})]})]})]}):null}function d(){let{getSessions:e,logoutSession:s}=(0,n.a)(),[t,o]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),[c,m]=(0,a.useState)(null),[u,x]=(0,a.useState)({isOpen:!1,sessionId:"",title:"",message:""}),h=async()=>{try{d(!0);let s=await e();o(s),m(null)}catch(e){m(e instanceof Error?e.message:"Failed to load sessions")}finally{d(!1)}};(0,a.useEffect)(()=>{h()},[]);let g=e=>{x({isOpen:!0,sessionId:e,title:"Logout Session",message:"Are you sure you want to logout this session? This action cannot be undone."})},b=async()=>{try{await s(u.sessionId),x({isOpen:!1,sessionId:"",title:"",message:""}),await h()}catch(e){alert(e instanceof Error?e.message:"Failed to logout session"),x({isOpen:!1,sessionId:"",title:"",message:""})}},p=e=>new Date(e).toLocaleString();return i?(0,r.jsx)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:(0,r.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded w-1/4 mb-4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded"}),(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded"}),(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded"})]})]})})}):c?(0,r.jsx)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("div",{className:"text-red-400 text-sm",children:c}),(0,r.jsx)("button",{onClick:h,className:"mt-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors",children:"Retry"})]})}):(0,r.jsxs)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:[(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-white",children:"Active Sessions"}),(0,r.jsxs)("button",{onClick:h,className:"bg-gray-700 hover:bg-gray-600 text-gray-200 px-3 py-1 rounded text-sm transition-colors flex items-center space-x-1",title:"Refresh sessions",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Refresh"})]})]}),0===t.length?(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"No active sessions found."}):(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,r.jsx)("div",{className:"border border-gray-600 rounded-lg p-4 bg-gray-700",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,r.jsxs)("span",{className:"text-sm font-medium text-white",children:["IP: ",e.ipAddress]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-300 mb-2",children:[(0,r.jsxs)("div",{className:"font-medium flex items-center space-x-1",children:[(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,r.jsx)("span",{children:"User Agent:"})]}),(0,r.jsx)("div",{className:"break-all bg-gray-600 p-2 rounded text-xs font-mono text-gray-200 mt-1",children:e.userAgent})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("span",{children:["Created: ",p(e.createdAt)]})]}),e.lastUsedAt&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("span",{children:["Last used: ",p(e.lastUsedAt)]})]})]})]}),e.isCurrent?(0,r.jsxs)("div",{className:"bg-green-600 text-white px-3 py-1 rounded text-sm flex items-center space-x-1",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Current Session"})]}):(0,r.jsxs)("button",{onClick:()=>g(e.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center space-x-1",title:"Logout this session",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,r.jsx)("span",{children:"Logout"})]})]})},e.id))})]}),(0,r.jsx)(l,{isOpen:u.isOpen,title:u.title,message:u.message,onConfirm:b,onCancel:()=>{x({isOpen:!1,sessionId:"",title:"",message:""})}})]})}var c=t(8504),m=t(3511);let u="force-dynamic";function x(){let{user:e,logout:s,logoutAll:t}=(0,n.a)(),[i,l]=(0,a.useState)("profile"),[d,u]=(0,a.useState)(!1),x=(0,c.useRouter)();return((0,a.useEffect)(()=>{u(!0)},[]),(0,a.useEffect)(()=>{d&&!e&&x.push("/")},[e,x,d]),d&&e)?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,r.jsx)(m.Z,{user:e,logout:s}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,r.jsx)("div",{className:"border-b border-gray-700 mb-6",children:(0,r.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,r.jsx)("button",{onClick:()=>l("profile"),className:"py-2 px-1 border-b-2 font-medium text-sm transition-colors ".concat("profile"===i?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-600"),children:"Profile"}),(0,r.jsx)("button",{onClick:()=>l("security"),className:"py-2 px-1 border-b-2 font-medium text-sm transition-colors ".concat("security"===i?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-600"),children:"Security"}),(0,r.jsx)("button",{onClick:()=>l("2fa"),className:"py-2 px-1 border-b-2 font-medium text-sm transition-colors ".concat("2fa"===i?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-600"),children:"Two-Factor Auth"})]})}),"profile"===i&&(0,r.jsx)(h,{}),"security"===i&&(0,r.jsx)(g,{}),"2fa"===i&&(0,r.jsx)(o,{})]})})]}):null}function h(){let{user:e,resendVerification:s}=(0,n.a)(),[t,o]=(0,a.useState)(""),[i,l]=(0,a.useState)(!1),d=async()=>{if(null==e?void 0:e.email){l(!0),o("");try{await s(e.email),o("Verification email sent. Please check your console for the link.")}catch(e){o(e.message||"Failed to resend verification email.")}finally{l(!1)}}};return e?(0,r.jsx)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-white mb-4",children:"User Profile"}),(0,r.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-400",children:"Full Name"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-white",children:e.name||"Not set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-400",children:"Username"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-white",children:e.username})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-400",children:"Email"}),(0,r.jsxs)("dd",{className:"mt-1 text-sm text-white flex items-center gap-2",children:[e.email,!e.emailVerifiedAt&&(0,r.jsx)("button",{onClick:d,disabled:i,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-2 py-1 rounded text-xs transition-colors",children:i?"Sending...":"Resend Verification"})]}),t&&(0,r.jsx)("p",{className:"mt-1 text-xs text-blue-400",children:t})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-400",children:"Email Verified"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-white",children:e.emailVerifiedAt?(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-800 text-green-200",children:"Verified"}):(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-800 text-yellow-200",children:"Unverified"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-400",children:"Role"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-white",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-800 text-blue-200 capitalize",children:e.role})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-400",children:"Member Since"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-white",children:new Date(e.created_at).toLocaleDateString()})]})]})]})}):null}function g(){let{logout:e,logoutAll:s}=(0,n.a)();return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(i,{}),(0,r.jsx)(d,{}),(0,r.jsx)("div",{className:"bg-gray-800 border border-gray-700 overflow-hidden sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-white mb-4",children:"Session Management"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-white",children:"Current Session"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Log out from your current session only."}),(0,r.jsx)("button",{onClick:e,className:"mt-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm transition-colors",children:"Logout Current Session"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-white",children:"All Sessions"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Log out from all devices and sessions."}),(0,r.jsx)("button",{onClick:s,className:"mt-2 bg-red-800 hover:bg-red-900 text-white px-4 py-2 rounded text-sm transition-colors",children:"Logout All Sessions"})]})]})]})})]})}}},function(e){e.O(0,[678,115,364,744],function(){return e(e.s=7013)}),_N_E=e.O()}]);